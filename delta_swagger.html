<!DOCTYPE html>
<html>
<head>
	<title>Delta Swagger</title>
  	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
  	<!-- https://code.google.com/archive/p/javascript-yaml-parser/downloads -->
  	<script type="text/javascript" src="src/yaml.js"></script>

  	<!-- http://alan.blog-city.com/jquerylinedtextarea.htm -->
  	<script type="text/javascript" src="src/jquery-linedtextarea.js"></script>
	<link href="src/jquery-linedtextarea.css" type="text/css" rel="stylesheet" />


</head>


<style type="text/css">

	body, html{
		width: 100%;
		height: 100%;
	}

	.content{
		width: 80%;
		text-align: center;
	}


	div>textarea{
		width: 100%;
		height: 200px;
	}

	textarea{
	    background: url(http://i.imgur.com/2cOaJ.png);
		background-attachment: local;
		background-repeat: no-repeat;
		padding-left: 35px;
		padding-top: 10px;
	    border-color:#ccc;
	}

	.result{
		width: 100%;
		text-align: left;
	}

</style>

<body>
  

<div class='content'>

	<h1>Î” Swagger</h1>

	<form action="#" onchange="compute();">  
		<div id="swagger1">
			<textarea class="lined"></textarea>
		</div>
	</form>

	<div id="swagger2">
		<textarea class="lined"></textarea>
	</div>

	<div class="result">
		<h2>Objet(s) avec majuscule(s)</h2>
		<div id="uppercase_object"></div>

		<h2>Objet(s) avec attributs en majuscule</h2>
		<div id="uppercase_attributs"></div>
	</div>

</div>


<script>

	// $(document).ready(function () {
	// 	$("#swagger2>textarea").html("coucou")

	// });
	// $(function() {
	// 	$(".lined").linedtextarea(
	// 		{selectedLine: 1}
	// 	);
	// });


	var text_swagger1;
	var test1;

	function compute() {
		text_swagger1 = $("#swagger1>textarea")[0].value
		// console.log(text_swagger1)

		js_swagger1 = YAML.eval(text_swagger1);
		str = JSON.stringify(js_swagger1.definitions);

		target = js_swagger1.definitions
		var textarea_content = "";
		for (var k in target){
		    if (target.hasOwnProperty(k)) {
		    	if (hasUpperCase(k)){
		    		textarea_content += "<br>" + target[k].type + " - " + k;
		    	}
		    }
		}
		$("#uppercase_object").html(textarea_content);


		var textarea_content2 = "";
		for (var k in target){
		    if (target.hasOwnProperty(k)) {

		    	textarea_content2 += "<br>" + target[k].type + " - " + k;

		    	for (var j in target[k].properties){
		    		if (target[k].properties.hasOwnProperty(j)) {
		    			if (hasUpperCase(j)){
				    		textarea_content2 += "<br>--------- " + j + " - " + target[k].properties[j].type;
				    	}
		    		}	
		    	}

		    	// if (hasUpperCase(k)){
		    	// 	textarea_content += target[k].type + " - " + k + "&#13;&#10;";
		    	// }



		    }
		}
		$("#uppercase_attributs").html(textarea_content2);



	}

	function hasUpperCase(str) {
        if(str.toLowerCase() != str) {
            return true;
        }
        return false;
    }

	// window.onload = function() {
 //        var test1 = YAML.eval("---\n- one\n- two");
 //        var test2 = YAML.eval("---\none: two");
    
 //        YAML.fromURL("example.yml", function(data) {
 //            var errors = YAML.getErrors();
 //            if(errors.length == 0)
 //                document.getElementById("out").innerHTML = "Done! Took " + YAML.getProcessingTime() + " miliseconds.";
 //            else {
 //                document.getElementById("out").innerHTML = errors.join("<br>");
 //            }
 //        });
 //    };

</script>

</body>
</html>